<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…¸ë¸”ë ˆìŠ¤ ë°ì´í„° í˜„í™© (í†µí•©ë³¸)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        /* Base Styling */
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif; [cite: 733]
            background-color: #1a1a1a; [cite: 734]
            color: #ddd;
            margin: 0;
            padding: 0;
            display: flex;
            min-height: 100vh;
            user-select: none; /* ì¤‘ìš”: ë“œë˜ê·¸ ì„ íƒ ì‹œ ë¸Œë¼ìš°ì € ê¸°ë³¸ í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */ [cite: 735]
        }

        .wrap {
            flex-grow: 1;
            padding: 20px 20px 20px 200px; 
            position: relative;
            max-width: calc(100vw - 320px);
            overflow: auto; [cite: 737]
        }

        /* --- New: ë¡œê³  ìŠ¤íƒ€ì¼ (ì˜¤ë¥¸ìª½ ìƒë‹¨) --- */
        .header-logo {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 120px; /* í¬ê¸° ì¡°ì ˆ */
            height: auto;
            z-index: 10; 
            filter: drop-shadow(0 0 5px rgba(255, 221, 102, 0.4));
        }
        /* ------------------------------------- */

        /* Setting Panel Styling */
        .setting-panel {
            position: fixed; [cite: 737]
            top: 0; [cite: 738]
            right: 0;
            width: 300px;
            height: 100vh;
            background-color: #2c2c2c;
            padding: 15px;
            box-shadow: -3px 0 10px rgba(0, 0, 0, 0.5);
            overflow-y: auto; [cite: 739]
            z-index: 100;
            user-select: auto; /* íŒ¨ë„ ë‚´ë¶€ëŠ” ì„ íƒ ê°€ëŠ¥í•˜ê²Œ */
        }

        .setting-panel h3 {
            font-size: 1.1em; [cite: 739]
            color: #ffdd66; [cite: 740]
            margin-top: 15px;
            margin-bottom: 10px;
        }

        .color-target-control label {
            margin-right: 15px; [cite: 740]
            cursor: pointer; [cite: 741]
            font-size: 0.9em;
        }

        .color-palette {
            display: flex; [cite: 741]
            flex-wrap: wrap; [cite: 742]
            gap: 4px;
            padding: 5px 0;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #333; [cite: 742]
        }

        .color-swatch {
            width: 20px; [cite: 743]
            height: 20px; [cite: 744]
            border: 1px solid #555;
            cursor: pointer;
            border-radius: 3px;
            transition: transform 0.1s; [cite: 744]
        }

        .color-swatch:hover {
            transform: scale(1.1); [cite: 745]
            border-color: #ffdd66; [cite: 746]
        }

        .download-button {
            width: 100%; [cite: 746]
            margin-top: 20px; [cite: 747]
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s; [cite: 747]
        }

        .download-button:hover {
            background-color: #45a049; [cite: 748]
        }

        .small-btn { padding:6px 8px; [cite: 749]
        background:#444;color:#fff;border-radius:4px;border:none;cursor:pointer } [cite: 750]
        .small-btn:hover{background:#555}
        .small-btn:disabled{background:#222; cursor:not-allowed; [cite: 750]
        color:#888;} [cite: 751]

        /* Menu Styling */
        .top-sub-menu {
            display: flex; [cite: 751]
            margin-bottom: 12px; [cite: 752]
            border-bottom: 2px solid #555;
            padding-bottom: 8px;
        }

        .menu {
            margin-right: 20px; [cite: 752]
            font-size: 0.9em; [cite: 753]
            color: #aaa;
            cursor: pointer;
            transition: color 0.2s;
        }

        .menu:hover {
            color: #fff; [cite: 754]
        }
        .menu.active { color: #fff; font-weight: 600; border-bottom: 2px solid #ffdd66; padding-bottom: 6px; [cite: 754, 755]
        }

        /* Left menu */
        .left-menu {
            position: fixed; [cite: 755]
            top: 0; [cite: 756]
            left: 0;
            width: 180px;
            height: 100vh;
            background-color: #222;
            padding: 20px 0; [cite: 756]
            box-shadow: 3px 0 10px rgba(0, 0, 0, 0.5); [cite: 757]
            z-index: 99; [cite: 758]
        }

        .left-item {
            padding: 10px 16px; [cite: 758]
            font-size: 0.95em; [cite: 759]
            color: #bbb;
            cursor: pointer;
            transition: background-color 0.12s, color 0.12s;
            border-left: 6px solid transparent;
            margin-bottom: 4px; [cite: 759]
            border-radius: 0 6px 6px 0; [cite: 760]
        }

        .left-item:hover {
            background: rgba(255,221,102,0.03); [cite: 760]
            color: #fff; [cite: 761]
        }

        .left-item.active {
            background: linear-gradient(90deg, rgba(255,221,102,0.06), rgba(255,221,102,0.02)); [cite: 761]
            border-left-color: #ffdd66; [cite: 762]
            color: #fff;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(0,0,0,0.4); [cite: 762]
        }

        /* menu indicator */
        .menu-indicator {
            margin-bottom: 12px; [cite: 763]
            padding: 8px 12px; [cite: 764]
            background: rgba(255,221,102,0.06);
            color: #ffdd66;
            border-radius: 6px;
            font-weight: 600;
            display: inline-block; [cite: 764]
        }

        /* Table Styling */
        .data-table {
            width: 100%; [cite: 765]
            border-collapse: collapse; [cite: 766]
            font-size: 14px;
            table-layout: fixed;
            user-select: auto; /* í…Œì´ë¸” ë‚´ë¶€ëŠ” í…ìŠ¤íŠ¸ í¸ì§‘ì„ ìœ„í•´ ì„ íƒ ê°€ëŠ¥ */ [cite: 766]
        }

        .data-table td {
            border: 1px solid #444; [cite: 766]
            padding: 5px 8px; [cite: 767]
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            /* line-height: 1; -> app.jsì—ì„œ ë™ì ìœ¼ë¡œ ê´€ë¦¬ */ [cite: 767, 768]
            height: 15px;
            box-sizing: border-box; [cite: 768]
            transition: background-color 0.1s, border-color 0.1s; [cite: 769]
        }

        /* Row Group Styles */
        .top-notice-row td {
            background-color: #581616; [cite: 769]
            color: #ffe6e6; [cite: 770]
            font-weight: bold;
            text-align: left;
            padding: 8px 12px;
            height: 25px; [cite: 771]
        }
        .top-notice-mark {
            color: #ffdd66; [cite: 771]
            margin-right: 8px; [cite: 772]
        }

        .top-data-header td, .bottom-data-header td {
            background-color: #444; [cite: 772]
            color: #fff; [cite: 773]
            font-weight: bold;
            height: 30px;
            min-width: 80px;
        }

        .middle-notice-row td {
            background-color: #3a3a3a; [cite: 773]
            color: #ffb3b3; [cite: 774]
            text-align: left;
            font-size: 0.9em;
            line-height: 1.4;
            height: 50px; [cite: 774, 775]
        }

        .bottom-data-row td {
            background-color: #333; [cite: 775]
            color: #ddd; [cite: 776]
        }

        /* Editable Content Styling */
        .data-table td[contenteditable="true"] {
            outline: none; [cite: 776, 777]
        }
        .data-table td[contenteditable="false"] {
            cursor: not-allowed; [cite: 777, 778]
        }

        /* Selection Box (for drag visual) */
        #selectionBox {
            position: absolute; [cite: 778, 779]
            border: 2px dashed #FFD700;
            background-color: rgba(255, 215, 0, 0.2);
            pointer-events: none;
            z-index: 10;
            display: none; [cite: 780]
        }

        /* Selected Cell Styling (Actual selection state) */
        .data-table td.selected {
            border: 2px solid #ffdd66 !important; [cite: 780, 781]
            box-shadow: inset 0 0 0 1px #ffdd66, 0 0 5px rgba(255, 221, 102, 0.5);
            position: relative;
            z-index: 5; [cite: 782]
        }

        /* Resizer Styling (Placeholder) */
        .col-resizer { position: absolute; [cite: 782, 783]
        right: -4px; top: 0; width: 8px; height: 100%; cursor: col-resize; z-index: 20; [cite: 784]
        }
        .row-resizer { position: absolute; bottom: -4px; right: 0; width: 100%; height: 8px; [cite: 784, 785]
        cursor: row-resize; z-index: 20; }
        .resizer-display { position: fixed; padding: 5px 10px; [cite: 785, 786]
        background: rgba(0, 0, 0, 0.8); color: #ffdd66; border-radius: 4px; pointer-events: none; opacity: 0; transition: opacity 0.2s; z-index: 101; font-size: 0.8em; [cite: 787]
        white-space: nowrap; } [cite: 787]

        /* small responsive fix */
        @media (max-width: 900px) {
            .wrap { padding-left: 20px; [cite: 787, 788]
        }
            .left-menu { display: none; [cite: 788, 789]
        }
        }
    </style>
</head>
<body>

<div class="setting-panel" id="settingPanel">
    <div style="color: #ffdd66; margin-top: 5px; margin-bottom: 10px; font-weight: bold;">
        â€» ì‚¬ìš©ë²•: í…Œì´ë¸” ì…€ì„ ë“œë˜ê·¸í•˜ì—¬ ì„ íƒí•œ í›„, ì•„ë˜ ì˜µì…˜ì„ í´ë¦­í•˜ë©´ ì ìš©ë©ë‹ˆë‹¤. [cite: 790]
    </div>

    <div class="color-target-control">
        <label><input type="radio" name="colorTarget" value="text" checked> ê¸€ììƒ‰ ì ìš©</label>
        <label><input type="radio" name="colorTarget" value="background"> ë°°ê²½ìƒ‰ ì ìš©</label>
    </div>

    <div class="color-control">
        <h3>ğŸ¨ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì„ íƒ (40ìƒ‰)</h3>
        <div class="color-palette" id="colorPaletteContainer"></div>
    </div>

    <div style="margin-top: 10px; padding-top: 15px; border-top: 1px solid #444;">
        <label for="fontSizeInput">ê¸€ê¼´ í¬ê¸° (px): </label>
        <input 
        [cite_start]type="number" id="fontSizeInput" min="8" max="48" value="14" style="width: 60px; margin-left: 5px; padding: 5px; color: black; border-radius: 3px; border: none;"> [cite: 791]
        <button id="applyFontSizeBtn" style="margin-left: 5px; padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; cursor: pointer; transition: background 0.2s;">ì ìš©</button>
    </div>

    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #444;">
        <h3>ğŸ“ ê·¸ë£¹ë³„ í–‰ ë†’ì´ (px)</h3>
        
        <div style="margin-bottom: 10px;">
           
        <label for="topRowHeightInput" style="display: block; margin-bottom: 5px;">ìƒë‹¨ ë°ì´í„° í–‰ ë†’ì´:</label> [cite: 792]
            <input type="number" id="topRowHeightInput" min="10" max="200" value="25" style="width: 60px; [cite: 792, 793]
        padding: 5px; color: black; border-radius: 3px; border: none;">
            <button id="applyTopRowHeightBtn" class="height-apply-btn" data-target="top-data" style="margin-left: 5px; [cite: 793, 794]
        padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; [cite: 794, 795]
        cursor: pointer;">ì ìš©</button>
        </div>

        <div style="margin-bottom: 10px;">
            <label for="middleNoticeRowHeightInput" style="display: block; [cite: 795, 796]
        margin-bottom: 5px;">ì¤‘ë‹¨ ê³µì§€/ì œëª© í–‰ ë†’ì´:</label>
            <input type="number" id="middleNoticeRowHeightInput" min="20" max="300" value="50" style="width: 60px; [cite: 796, 797]
        padding: 5px; color: black; border-radius: 3px; border: none;">
            <button id="applyMiddleNoticeRowHeightBtn" class="height-apply-btn" data-target="middle-notice" style="margin-left: 5px; [cite: 797, 798]
        padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; [cite: 798, 799]
        cursor: pointer;">ì ìš©</button>
        </div>

        <div>
            <label for="bottomRowHeightInput" style="display: block; [cite: 799, 800]
        margin-bottom: 5px;">í•˜ë‹¨ ë°ì´í„° í–‰ ë†’ì´:</label>
            <input type="number" id="bottomRowHeightInput" min="10" max="200" value="25" style="width: 60px; [cite: 800, 801]
        padding: 5px; color: black; border-radius: 3px; border: none;">
            <button id="applyBottomRowHeightBtn" class="height-apply-btn" data-target="bottom-data" style="margin-left: 5px; [cite: 801, 802]
        padding: 5px 12px; background: #555; color: white; border: none; border-radius: 3px; [cite: 802, 803]
        cursor: pointer;">ì ìš©</button>
        </div>
        <button id="autoFitBtn" class="small-btn" style="margin-top: 10px; [cite: 803, 804]
        width: 100%; background: #007bff;">ì—´ ë„ˆë¹„ ìë™ ë§ì¶¤ (Auto-Fit)</button>
    </div>

    <div style="margin-top: 15px; padding-top: 15px; [cite: 804, 805]
        border-top: 1px solid #444;">
        <h3>âš™ï¸ ì‘ì—… ë„êµ¬</h3>
        <div style="display:flex; [cite: 806]
        gap:8px; margin-bottom:8px;">
            <button id="autoSaveToggleBtn" class="small-btn">ìë™ì €ì¥: OFF</button>
            <button id="saveNowBtn" class="small-btn">ì €ì¥</button>
            <button id="copyBtn" class="small-btn">ë³µì‚¬</button>
            <button id="pasteBtn" class="small-btn">ë¶™ì—¬ë„£ê¸°</button>
        </div>
        <div style="display:flex; [cite: 807]
        gap:8px; margin-bottom:8px;">
            <button id="addRowBtn" class="small-btn">í–‰ ì¶”ê°€</button>
            <button id="addColBtn" class="small-btn">ì—´ ì¶”ê°€</button>
            <button id="deleteRowBtn" class="small-btn">í–‰ ì‚­ì œ</button>
            <button id="deleteColBtn" class="small-btn">ì—´ ì‚­ì œ</button>
        </div>
        <div style="display:flex; [cite: 808]
        gap:8px;">
            <button id="toggleAdminBtn" class="small-btn" style="background: #a33;">ê´€ë¦¬ì ëª¨ë“œ: OFF</button>
            <button id="downloadBtn" class="small-btn" style="background: #4CAF50;">ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</button>
        </div>
    </div>

    <button class="download-button" id="downloadFullBtn" style="margin-top:12px;">ğŸ–¼ï¸ í…Œì´ë¸” ì˜ì—­ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (PNG)</button>
</div>

<div class="left-menu" id="leftMenu">
    <div class="left-item active">ë©”ì¸ í™”ë©´</div>
    <div class="left-item">[ë§¤ì¹­/ê³ ê° ìƒíƒœ]</div>
    <div class="left-item">ì£¼ë¬¸ ìƒíƒœ</div>
    <div class="left-item">ì¸ì¦ ìƒíƒœ</div>
    <div class="left-item">[ìƒë‹´/ë¬¸ì˜]</div>
    <div class="left-item">ì§ë¬´ ë¬¸ì˜</div>
   
    <div class="left-item">ì „êµ­ ë§Œë‚¨</div> 
    <div class="left-item">[ê´€ë¦¬/ë°ì´í„°]</div>
    <div class="left-item">ì‹¤ì‹œê°„ ë°ì´í„°</div>
    <div class="left-item">ì‹¤ì‹œê°„ ì˜¤ë¥˜</div>
    <div class="left-item">ë°ì´í„° ë¶„ì„</div>
    <div class="left-item">í¬ì¸íŠ¸ ì¡°íšŒ</div>
    <div class="left-item">ìœ í¥ ê´€ë¦¬</div>
    <div class="left-item">íšŒì› ê´€ë¦¬</div>
    <div class="left-item">íšŒì› ìŠ¹ì¸</div>
    <div class="left-item">íšŒì› íƒˆí‡´</div>
    <div class="left-item">ë‹´ë‹¹ ì‹¤ì¥</div>
</div>

<div class="wrap">
    
    <img src="unnamed (8).png" alt="ë…¸ë¸”ë ˆìŠ¤ ë¡œê³ " class="header-logo">
    <div id="selectionBox"></div>

    <div class="top-sub-menu" id="topSubMenu">
        <div class="menu active">ë¸”ë ˆìŠ¤ ì „êµ­ í”„ë ˆìŠ¤í‹°ì§€ ì„œë¹„ìŠ¤</div>
        <div class="menu">VIP íšŒì› ì „ìš© í†µí•© 
        ë§¤ë‹ˆì§€ë¨¼íŠ¸</div> [cite: 810]
        <div class="menu">ë…¸ë¸”ë ˆìŠ¤ íšŒì› ì „ìš©ë£¸</div>
    </div>
    
    <div id="menuIndicator" class="menu-indicator">ì„ íƒ: ë©”ì¸ í™”ë©´</div>

    <table class="data-table" id="capture-area">
        <tbody>
            <tr class="top-notice-row">
                <td colspan="5" contenteditable="false">
                    <span class="top-notice-mark">DAMAGE!</span> ì£¼ì˜ì‚¬í•­ 4ë‹¨ê³„ì—ì„œ ì¼ì¹˜ íŒŒíŠ¸ë„ˆì‹­ìœ¼ë¡œ í†µí•©ëœ ìœ í˜•ë§Œì„ 
        ì„ íƒí•˜ì—¬ ê³µìœ  ì„ë¬´ë¥¼ ì™„ë£Œí•˜ë©° í•¨ê»˜ í• ë•Œì˜ ê¸ˆì¼ ê²°ì œ ê¸ˆì•¡ í›„ ê³µë™ ì´ìµì„ ë§ˆê°í•´ì•¼ í•©ë‹ˆë‹¤! [cite: 811, 812]
                </td>
            </tr>
            
            <tr class="top-data-header">
                <td contenteditable="...
        </tbody>
    </table>
</div>

<div class="resizer-display" id="resizerDisplay"></div>

<script type="module">
    // (ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ)
</script>
</body>
</html>
